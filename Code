# Loading and preprocessing the data
if (!file.exists('activity.csv')) {
  unzip(zipfile = "activity.zip")
}
activityData <- read.csv(file="activity.csv", header=TRUE)

# What is mean total number of steps taken per day?
# Calculate the total number of steps taken per day

total_steps_per_day <- sum(activityData$steps, na.rm = TRUE)
print (total_steps_per_day)
## [1] 570608

# Make a histogram of the total number of steps taken per day
total_steps <- aggregate(steps ~ date, activityData, FUN=sum, na.rm = TRUE)

hist(total_steps$steps,
     main = "Total Steps per Day",
     xlab = "Number of Steps")

# Calculate and report the mean and median of total steps taken per day
meansteps <- mean(total_steps$steps, na.rm = TRUE)
medsteps <- median(total_steps$steps, na.rm = TRUE)
print (meansteps)
print (medsteps)
## [1] 10766.19
## [1] 10765

#What is the average daily activity pattern?
# Make a time-series plot of the 5-minute interval and the average number of
# steps taken, averaged across all days.

meanStepsByInt <- aggregate(steps ~ interval, activityData, mean)
plot(x = meanStepsByInt$interval, y = meanStepsByInt$steps, type = "l") 

# Which 5-minute interval across all days contain the maximum number of steps
maxday <- meanStepsByInt[which.max(meanStepsByInt$steps),]
print (maxday)
##[1]     interval    steps
104      835 206.1698
